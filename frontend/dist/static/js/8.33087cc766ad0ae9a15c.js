webpackJsonp([8],{Jj2W:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("woOf"),s=a.n(o),l=a("3lel"),i=a("P9l9"),n={data:function(){return{inputdate0:"",inputdate1:"",inputdate2:"",inputdate3:"",projectnum:"",projectname:"",onwcopte:"",selectvalue:"0",fundtypevalue:"",options:l.b,dataList:[],dialogVisible:!1,modifyVisible:!1,uploadIcon:!1,modifyuploadIcon:!1,loading:!0,operationShow:!0,examineAdopt:!1,fundtypeOption:[{value:"",label:"全部"},{value:"1",label:"对私"},{value:"0",label:"对公"}],paccountypeops:l.c,paccountFliter:l.d,examineFilters:l.a,currentPage:1,searchState:0,projectOption:[],pushId:"",projectItem:[],addCostApply:{project:"",send_pic:"",fundtype:"",fund_rec:"",company:"",send_date:""},initAddCostApply:{project:"",send_pic:"",fundtype:"",fund_rec:"",company:"",send_date:""},rules:{project:[{required:!0,message:"项目名称",trigger:"blur"}],send_pic:[{required:!0,message:"请上传打款截图",trigger:"blur"}],fundtype:[{required:!0,message:"请选择公私类型",trigger:"blur"}],fund_rec:[{required:!0,message:"请选择打款金额",trigger:"blur"}],company:[{required:!0,message:"请输入甲方公司名称",trigger:"blur"}],send_date:[{required:!0,message:"请选择打款时间",trigger:"blur"}]},modifyCost:{project:"",send_pic:"",fundtype:"",fund_rec:"",company:"",send_date:""},imgData:{token:"",key:""}}},created:function(){this.getCostDatalist()},methods:{getCostDatalist:function(){var t=this,e=this.conditionDate();"1"!==this.selectvalue?this.operationShow=!0:this.operationShow=!1,"2"===this.selectvalue?this.examineAdopt=!0:this.examineAdopt=!1,Object(i.v)(this.currentPage,e).then(function(e){t.loading=!1,t.dataList=e.data,console.log(t.dataList)}).catch(function(t){console.log(t)})},conditionDate:function(){return{params:{apply_date_0:this.inputdate0,apply_date_1:this.inputdate1,send_date_0:this.inputdate2,send_date_1:this.inputdate3,projectname:this.projectname,company:this.onwcopte,state:this.selectvalue,fundtype:this.fundtypevalue}}},costApplyBtn:function(){this.dialogVisible=!0},handleAvatarSuccess:function(t,e){this.addCostApply.send_pic="http://image.fuliunion.com/"+t.key},beforeAvatarUpload:function(t){var e=this;return this.addCostApply.send_pic="",this.uploadIcon=!0,Object(i.H)().then(function(t){e.imgData.token=t.data.token,e.imgData.key=t.data.key})},unsend_pic:function(){this.addCostApply.send_pic="",this.uploadIcon=!1},modifyAvatarSuccess:function(t,e){this.modifyCost.send_pic="http://image.fuliunion.com/"+t.key},modifyAvatarUpload:function(t){var e=this;return this.modifyCost.send_pic="",this.modifyuploadIcon=!0,Object(i.H)().then(function(t){e.imgData.token=t.data.token,e.imgData.key=t.data.key})},modifyUnSend_pic:function(){this.addCostApply.send_pic="",this.modifyCost.send_pic="",this.modifyuploadIcon=!1},postCostData:function(t){var e=this;this.$refs[t].validate(function(a){if(!a)return e.$message.error("提交有误，请检查提交项！"),!1;Object(i.M)(e.addCostApply).then(function(a){0===a.data.code?(e.addCostApply=e.initAddCostApply,e.$refs[t].resetFields(),e.$message({type:"success",message:"新建费用申请成功!"}),e.loading=!0,e.dialogVisible=!1,e.getCostDatalist(),e.uploadIcon=!1):(e.dialogVisible=!1,e.$message(a.data.detail))}).catch(function(t){console.log(t)})})},getProjectList:function(){var t=this;Object(i.h)().then(function(e){e.data.results.forEach(function(e,a){t.projectOption.push({value:e.id.toString(),label:e.name}),t.projectItem.push({id:e.id.toString(),fundtype:e.paccountype,company:e.company})})}).catch(function(t){console.log(t)})},handleCurrentChange:function(t){this.loading=!0,this.currentPage=t,this.getCostDatalist()},modifyCostBtn:function(t){this.modifyVisible=!0,s()(this.modifyCost,t)},modifyCostData:function(){var t=this;"2"===this.selectvalue&&(this.modifyCost.state="0"),delete this.modifyCost.apply_man,this.modifyCost.audit_man&&delete this.modifyCost.audit_man,console.log(this.modifyCost),Object(i.Q)(this.modifyCost.id,this.modifyCost).then(function(e){t.$message({type:"success",message:"修改成功!"}),t.loading=!0,t.modifyVisible=!1,t.getCostDatalist()}).catch(function(e){t.modifyVisible=!1,console.log(e)})},deleteCostBtn:function(t){var e=this;this.$confirm("此操作将永久删除该申请, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.k)(t.id).then(function(t){0===t.data.code?(e.$message({type:"success",message:"删除成功!"}),e.loading=!0,e.getCostDatalist()):e.$message(t.data.detail)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},searchBtn:function(){this.currentPage=1,this.getCostDatalist()}},computed:{projectNameValue:function(){return this.addCostApply.project}},mounted:function(){this.getProjectList()},watch:{selectvalue:function(){this.dataList=[],this.loading=!0,this.currentPage=1,this.getCostDatalist()},fundtypevalue:function(){this.dataList=[],this.loading=!0,this.currentPage=1,this.getCostDatalist()},projectNameValue:function(t){var e=this;this.projectItem.forEach(function(a,o){a.id===t&&(e.addCostApply.fundtype=a.fundtype,e.addCostApply.company=a.company)})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"costadmin"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"input_search"},[a("div",{staticClass:"search marginvi search_box"},[a("label",{staticClass:"labeltext"},[t._v("申请日期")]),t._v(" "),a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.inputdate0,callback:function(e){t.inputdate0=e},expression:"inputdate0"}}),t._v(" "),a("span",{staticClass:"line"},[t._v(" — ")]),t._v(" "),a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.inputdate1,callback:function(e){t.inputdate1=e},expression:"inputdate1"}})],1),t._v(" "),a("div",{staticClass:"search"},[a("label",{staticClass:"labeltext"},[t._v("项目名称")]),t._v(" "),a("el-input",{attrs:{size:"medium"},model:{value:t.projectname,callback:function(e){t.projectname=e},expression:"projectname"}})],1),t._v(" "),a("div",{staticClass:"search"},[a("label",{staticClass:"labeltext"},[t._v("甲方公司")]),t._v(" "),a("el-input",{attrs:{size:"medium"},model:{value:t.onwcopte,callback:function(e){t.onwcopte=e},expression:"onwcopte"}})],1),t._v(" "),a("div",{staticClass:"select"},[a("label",{staticClass:"label"},[t._v("对公对私")]),t._v(" "),a("el-select",{attrs:{size:"medium",placeholder:"请选择"},model:{value:t.fundtypevalue,callback:function(e){t.fundtypevalue=e},expression:"fundtypevalue"}},t._l(t.fundtypeOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])])],1),t._v(" "),a("el-row",{staticClass:"row_top"},[a("el-col",{attrs:{span:20}},[a("div",{staticClass:"flex_default"},[a("div",{staticClass:"search marginvi search_box"},[a("label",{staticClass:"labeltext"},[t._v("打款日期")]),t._v(" "),a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.inputdate2,callback:function(e){t.inputdate2=e},expression:"inputdate2"}}),t._v(" "),a("span",{staticClass:"line"},[t._v(" — ")]),t._v(" "),a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.inputdate3,callback:function(e){t.inputdate3=e},expression:"inputdate3"}})],1),t._v(" "),a("div",{staticClass:"select"},[a("label",{staticClass:"label"},[t._v("审核状态")]),t._v(" "),a("el-select",{attrs:{size:"medium",placeholder:"请选择"},model:{value:t.selectvalue,callback:function(e){t.selectvalue=e},expression:"selectvalue"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"flexright"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.searchBtn}},[t._v("搜索")])],1)])],1),t._v(" "),a("el-row",{staticClass:"row_top"},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"flexright"},[a("el-button",{attrs:{size:"medium",type:"info"},on:{click:t.costApplyBtn}},[t._v("费用申请")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"费用申请",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"form_table"},[a("el-form",{ref:"addCostApply",staticClass:"demo-addCostApply",attrs:{model:t.addCostApply,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"项目名称",prop:"project"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择"},model:{value:t.addCostApply.project,callback:function(e){t.$set(t.addCostApply,"project",e)},expression:"addCostApply.project"}},t._l(t.projectOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"打款截图",prop:"send_pic"}},[a("div",{staticClass:"img_long"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://upload-z2.qiniup.com",data:t.imgData,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.addCostApply.send_pic?a("img",{ref:"extensionimg",staticClass:"avatar",attrs:{src:t.addCostApply.send_pic}}):a("i",{staticClass:"avatar-uploader-icon",class:[t.uploadIcon?"el-icon-loading":"el-icon-plus"]})]),t._v(" "),a("span",{on:{click:t.unsend_pic}},[t._v("删除长图 ")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"对公对私",prop:"fundtype"}},[a("el-select",{attrs:{size:"medium",placeholder:"请选择"},model:{value:t.addCostApply.fundtype,callback:function(e){t.$set(t.addCostApply,"fundtype",e)},expression:"addCostApply.fundtype"}},t._l(t.paccountypeops,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"打款时间",prop:"send_date"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.addCostApply.send_date,callback:function(e){t.$set(t.addCostApply,"send_date",e)},expression:"addCostApply.send_date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"打款金额",prop:"fund_rec"}},[a("el-input",{attrs:{size:"medium"},model:{value:t.addCostApply.fund_rec,callback:function(e){t.$set(t.addCostApply,"fund_rec",e)},expression:"addCostApply.fund_rec"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"甲方公司名称",prop:"company"}},[a("el-input",{attrs:{size:"medium"},model:{value:t.addCostApply.company,callback:function(e){t.$set(t.addCostApply,"company",e)},expression:"addCostApply.company"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"record"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:t.addCostApply.record,callback:function(e){t.$set(t.addCostApply,"record",e)},expression:"addCostApply.record"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.postCostData("addCostApply")}}},[t._v("确 定")])],1)])],1),t._v(" "),a("el-row",{staticClass:"row_top row_bottom"},[a("div",{staticClass:"table-list"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList.results}},[a("el-table-column",{attrs:{label:"日期",prop:"apply_date"}}),t._v(" "),a("el-table-column",{attrs:{label:"项目名称",prop:"projectname"}}),t._v(" "),a("el-table-column",{attrs:{label:"打款金额",prop:"fund_rec"}}),t._v(" "),a("el-table-column",{attrs:{label:"打款时间",prop:"send_date"}}),t._v(" "),a("el-table-column",{attrs:{label:"打款截图"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"img_box"},[a("img",{attrs:{src:t.row.send_pic}})])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"对公对私"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.paccountFliter[e.row.fundtype]))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"甲方公司名称",prop:"company"}}),t._v(" "),a("el-table-column",{attrs:{label:"审核状态",prop:"invoicenum"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.examineFilters[e.row.state]))])]}}])}),t._v(" "),t.examineAdopt?a("el-table-column",{key:Math.random(),attrs:{label:"拒绝原因",prop:"audit_refused_reason"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"record"}}),t._v(" "),t.operationShow?a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operation_button"},[a("div",{staticClass:"op_button_padding"},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.modifyCostBtn(e.row)}}},[t._v("修改")])],1),t._v(" "),a("div",{staticClass:"op_button_padding"},[a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){t.deleteCostBtn(e.row)}}},[t._v("删除")])],1)])]}}])}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","page-size":10,"current-page":this.currentPage,layout:"prev, pager, next, total, jumper",total:this.dataList.recordCount},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"费用修改",visible:t.modifyVisible,width:"50%"},on:{"update:visible":function(e){t.modifyVisible=e}}},[a("div",{staticClass:"form_table"},[a("el-form",{ref:"modifyCost",staticClass:"demo-modifyCost",attrs:{model:t.modifyCost,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"项目名称",prop:"project"}},[a("el-select",{attrs:{size:"medium",filterable:"",placeholder:"请选择"},model:{value:t.modifyCost.project,callback:function(e){t.$set(t.modifyCost,"project",e)},expression:"modifyCost.project"}},t._l(t.projectOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"打款截图",prop:"send_pic"}},[a("div",{staticClass:"img_long"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://upload-z2.qiniup.com",data:t.imgData,"show-file-list":!1,"on-success":t.modifyAvatarSuccess,"before-upload":t.modifyAvatarUpload}},[t.modifyCost.send_pic?a("img",{ref:"extensionimg",staticClass:"avatar",attrs:{src:t.modifyCost.send_pic}}):a("i",{staticClass:"avatar-uploader-icon",class:[t.modifyuploadIcon?"el-icon-loading":"el-icon-plus"]})]),t._v(" "),a("span",{on:{click:t.modifyUnSend_pic}},[t._v("删除长图 ")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"对公对私",prop:"fundtype"}},[a("el-select",{attrs:{size:"medium",placeholder:"请选择"},model:{value:t.modifyCost.fundtype,callback:function(e){t.$set(t.modifyCost,"fundtype",e)},expression:"modifyCost.fundtype"}},t._l(t.paccountypeops,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"打款时间",prop:"send_date"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"medium",type:"date",placeholder:"选择日期"},model:{value:t.modifyCost.send_date,callback:function(e){t.$set(t.modifyCost,"send_date",e)},expression:"modifyCost.send_date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"打款金额",prop:"fund_rec"}},[a("el-input",{attrs:{size:"medium"},model:{value:t.modifyCost.fund_rec,callback:function(e){t.$set(t.modifyCost,"fund_rec",e)},expression:"modifyCost.fund_rec"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"甲方公司名称",prop:"company"}},[a("el-input",{attrs:{size:"medium"},model:{value:t.modifyCost.company,callback:function(e){t.$set(t.modifyCost,"company",e)},expression:"modifyCost.company"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"record"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:t.modifyCost.record,callback:function(e){t.$set(t.modifyCost,"record",e)},expression:"modifyCost.record"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.modifyCostData("modifyCost")}}},[t._v("确 定")])],1)])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(n,d,!1,function(t){a("Q8zy")},null,null);e.default=c.exports},Q8zy:function(t,e){}});
//# sourceMappingURL=8.33087cc766ad0ae9a15c.js.map